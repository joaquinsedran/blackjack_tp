<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Blackjack</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #0a5f0a, #0d8b0d);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .mesa {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        /* √Åreas del crupier y jugador */
        .crupier {
            margin-bottom: 30px;
            text-align: center;
        }

        .jugador {
            text-align: center;
            margin-bottom: 20px;
        }

        .crupier h2, .jugador h2 {
            margin-bottom: 15px;
            color: #ffd700;
        }

        /* Contenedores de manos (para split) */
        .manos-jugador {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .mano-container {
            margin: 10px;
        }

        .mano-container h3 {
            margin-bottom: 10px;
            color: #ffd700;
            font-size: 16px;
        }

        .mano {
            display: flex;
            justify-content: center;
            gap: 10px;
            min-height: 120px;
            margin-bottom: 10px;
        }

        .puntos-mano {
            font-size: 18px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 10px;
        }

        /* Estilo de las cartas */
        .carta {
            width: 70px;
            height: 100px;
            background: white;
            border-radius: 6px;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: black;
            position: relative;
            transition: transform 0.3s ease;
        }

        .carta.roja {
            color: red;
        }

        .carta.negra {
            color: black;
        }

        .carta.boca-abajo {
            background: linear-gradient(45deg, #ff0000, #cc0000);
            color: transparent;
        }

        .carta.boca-abajo::before {
            content: "?";
            color: white;
            font-size: 24px;
        }

        /* Animaciones */
        @keyframes repartirCarta {
            0% {
                transform: translateY(-100px) rotate(-10deg);
                opacity: 0;
            }
            100% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
        }

        @keyframes voltearCarta {
            0% {
                transform: rotateY(0deg);
            }
            50% {
                transform: rotateY(90deg);
            }
            100% {
                transform: rotateY(0deg);
            }
        }

        .carta-repartida {
            animation: repartirCarta 0.5s ease-out;
        }

        .carta-volteada {
            animation: voltearCarta 0.6s ease-in-out;
        }

        /* Controles del juego */
        .controles {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .boton {
            padding: 10px 20px;
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .boton:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .pedir { background: #4CAF50; color: white; }
        .plantarse { background: #f44336; color: white; }
        .doblar { background: #2196F3; color: white; }
        .dividir { background: #FF9800; color: white; }
        .nueva-partida { background: #9C27B0; color: white; }

        .boton:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .boton-activo {
            border: 3px solid #ffd700;
            box-shadow: 0 0 10px gold;
        }

        /* Informaci√≥n del juego */
        .info {
            text-align: center;
            margin: 15px 0;
            font-size: 16px;
            min-height: 25px;
            color: #ffd700;
            font-weight: bold;
        }

        /* Apuestas y fichas */
        .apuesta-container {
            text-align: center;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
        }

        .fichas {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .ficha {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid white;
            transition: all 0.3s ease;
            font-size: 12px;
        }

        .ficha:hover {
            transform: scale(1.1);
        }

        .ficha-5 { background: #FF6B6B; }
        .ficha-10 { background: #4ECDC4; }
        .ficha-25 { background: #FFD166; }
        .ficha-50 { background: #06D6A0; }
        .ficha-100 { background: #118AB2; }

        .apuesta-display {
            font-size: 20px;
            font-weight: bold;
            margin: 10px 0;
            color: #ffd700;
        }

        .saldo {
            font-size: 16px;
            margin-top: 5px;
            color: white;
        }

        /* Estado de las manos en split */
        .mano-completada {
            opacity: 0.6;
        }

        .mano-activa {
            border: 2px solid #ffd700;
            padding: 5px;
            border-radius: 10px;
            background: rgba(255, 215, 0, 0.1);
        }
    </style>
</head>
<body>
<div class="mesa">
    <h1 style="text-align: center; margin-bottom: 20px; color: #ffd700;">üé∞ Blackjack üé∞</h1>

    <!-- √Årea del Crupier -->
    <div class="crupier">
        <h2>Crupier</h2>
        <div class="mano" id="manoCrupier"></div>
        <div class="puntos" id="puntosCrupier">Puntos: ?</div>
    </div>

    <!-- Informaci√≥n del juego -->
    <div class="info" id="infoJuego">¬°Bienvenido al Blackjack!</div>

    <!-- √Årea del Jugador (din√°mica para split) -->
    <div class="jugador">
        <h2>Jugador</h2>
        <div class="manos-jugador" id="manosJugador">
            <!-- Las manos aparecer√°n aqu√≠ din√°micamente -->
        </div>

        <!-- Sistema de apuestas -->
        <div class="apuesta-container" id="apuestaContainer">
            <h3>Haz tu apuesta</h3>
            <div class="fichas">
                <div class="ficha ficha-5" data-valor="5">$5</div>
                <div class="ficha ficha-10" data-valor="10">$10</div>
                <div class="ficha ficha-25" data-valor="25">$25</div>
                <div class="ficha ficha-50" data-valor="50">$50</div>
                <div class="ficha ficha-100" data-valor="100">$100</div>
            </div>
            <div class="apuesta-display">Apuesta: $<span id="apuestaActual">0</span></div>
            <div class="saldo">Saldo: $<span id="saldoJugador">1000</span></div>
        </div>
    </div>

    <!-- Controles del juego -->
    <div class="controles">
        <button class="boton pedir" id="btnPedir">Pedir Carta</button>
        <button class="boton plantarse" id="btnPlantarse">Plantarse</button>
        <button class="boton doblar" id="btnDoblar">Doblar Apuesta</button>
        <button class="boton dividir" id="btnDividir">Dividir</button>
        <button class="boton nueva-partida" id="btnNuevaPartida">Nueva Partida</button>
    </div>
</div>

<script>
    // Variables del juego
    let juegoActivo = false;
    let apuestaBase = 0;
    let saldoJugador = 1000;
    let manoCrupierCartas = [];
    let mazo = [];

    // Variables para split
    let manosJugador = []; // Array de manos cuando hay split
    let manoActivaIndex = 0; // √çndice de la mano activa actual
    let enModoSplit = false;

    // Elementos del DOM
    const manoCrupier = document.getElementById('manoCrupier');
    const manosJugadorContainer = document.getElementById('manosJugador');
    const puntosCrupier = document.getElementById('puntosCrupier');
    const infoJuego = document.getElementById('infoJuego');
    const apuestaContainer = document.getElementById('apuestaContainer');
    const apuestaDisplay = document.getElementById('apuestaActual');
    const saldoDisplay = document.getElementById('saldoJugador');

    // Botones
    const btnPedir = document.getElementById('btnPedir');
    const btnPlantarse = document.getElementById('btnPlantarse');
    const btnDoblar = document.getElementById('btnDoblar');
    const btnDividir = document.getElementById('btnDividir');
    const btnNuevaPartida = document.getElementById('btnNuevaPartida');

    // Fichas
    const fichas = document.querySelectorAll('.ficha');

    // Crear mazo de cartas
    function crearMazo() {
        const palos = ['‚ô•', '‚ô¶', '‚ô£', '‚ô†'];
        const valores = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        mazo = [];

        for (let palo of palos) {
            for (let valor of valores) {
                mazo.push({ valor, palo });
            }
        }
        barajarMazo();
    }

    // Barajar el mazo
    function barajarMazo() {
        for (let i = mazo.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [mazo[i], mazo[j]] = [mazo[j], mazo[i]];
        }
    }

    // Repartir carta aleatoria
    function repartirCartaAleatoria() {
        if (mazo.length === 0) crearMazo();
        return mazo.pop();
    }

    // Calcular puntos de una mano
    function calcularPuntos(mano) {
        let puntos = 0;
        let ases = 0;

        for (let carta of mano) {
            if (carta.valor === 'A') {
                ases++;
                puntos += 11;
            } else if (['K', 'Q', 'J'].includes(carta.valor)) {
                puntos += 10;
            } else {
                puntos += parseInt(carta.valor);
            }
        }

        while (puntos > 21 && ases > 0) {
            puntos -= 10;
            ases--;
        }

        return puntos;
    }

    // Funci√≥n para crear elemento de carta visual
    function crearCartaElemento(valor, palo, bocaAbajo = false) {
        const carta = document.createElement('div');
        carta.className = `carta ${bocaAbajo ? 'boca-abajo' : ''}`;
        carta.classList.add(palo === '‚ô•' || palo === '‚ô¶' ? 'roja' : 'negra');

        if (!bocaAbajo) {
            carta.innerHTML = `
                    <div style="position: absolute; top: 3px; left: 3px; font-size: 14px;">${valor}</div>
                    <div style="font-size: 20px;">${palo}</div>
                    <div style="position: absolute; bottom: 3px; right: 3px; font-size: 14px; transform: rotate(180deg);">${valor}</div>
                `;
        }

        return carta;
    }

    // Funci√≥n para repartir carta con animaci√≥n
    function repartirCarta(contenedor, carta, bocaAbajo = false, delay = 0) {
        return new Promise(resolve => {
            setTimeout(() => {
                const elementoCarta = crearCartaElemento(carta.valor, carta.palo, bocaAbajo);
                elementoCarta.classList.add('carta-repartida');
                contenedor.appendChild(elementoCarta);

                setTimeout(() => {
                    elementoCarta.classList.remove('carta-repartida');
                    resolve();
                }, 500);
            }, delay);
        });
    }

    // Funci√≥n para crear interfaz de una mano
    function crearManoUI(manoIndex, esActiva = false) {
        const manoContainer = document.createElement('div');
        manoContainer.className = `mano-container ${esActiva ? 'mano-activa' : ''}`;
        manoContainer.id = `mano-${manoIndex}`;

        const titulo = document.createElement('h3');
        titulo.textContent = enModoSplit ? `Mano ${manoIndex + 1}` : 'Tu mano';

        const puntos = document.createElement('div');
        puntos.className = 'puntos-mano';
        puntos.id = `puntos-mano-${manoIndex}`;
        puntos.textContent = 'Puntos: 0';

        const manoElement = document.createElement('div');
        manoElement.className = 'mano';
        manoElement.id = `mano-element-${manoIndex}`;

        manoContainer.appendChild(titulo);
        manoContainer.appendChild(puntos);
        manoContainer.appendChild(manoElement);

        return manoContainer;
    }

    // Funci√≥n para actualizar la interfaz de manos
    function actualizarUIManos() {
        manosJugadorContainer.innerHTML = '';

        manosJugador.forEach((mano, index) => {
            const esActiva = index === manoActivaIndex && !mano.completada;
            const manoUI = crearManoUI(index, esActiva);
            manosJugadorContainer.appendChild(manoUI);

            // Mostrar cartas de esta mano
            const manoElement = document.getElementById(`mano-element-${index}`);
            manoElement.innerHTML = '';

            mano.cartas.forEach(carta => {
                const elementoCarta = crearCartaElemento(carta.valor, carta.palo);
                manoElement.appendChild(elementoCarta);
            });

            // Actualizar puntos
            const puntosElement = document.getElementById(`puntos-mano-${index}`);
            puntosElement.textContent = `Puntos: ${mano.puntos}`;

            if (mano.completada) {
                manoUI.classList.add('mano-completada');
            }
        });
    }

    // Funci√≥n para voltear carta del crupier
    function voltearCartaCrupier() {
        const primeraCarta = manoCrupier.children[0];
        if (primeraCarta && primeraCarta.classList.contains('boca-abajo')) {
            primeraCarta.classList.add('carta-volteada');

            setTimeout(() => {
                const cartaReal = manoCrupierCartas[0];
                primeraCarta.classList.remove('boca-abajo');
                primeraCarta.innerHTML = `
                        <div style="position: absolute; top: 3px; left: 3px; font-size: 14px;">${cartaReal.valor}</div>
                        <div style="font-size: 20px;">${cartaReal.palo}</div>
                        <div style="position: absolute; bottom: 3px; right: 3px; font-size: 14px; transform: rotate(180deg);">${cartaReal.valor}</div>
                    `;
                primeraCarta.classList.add(cartaReal.palo === '‚ô•' || cartaReal.palo === '‚ô¶' ? 'roja' : 'negra');

                setTimeout(() => {
                    primeraCarta.classList.remove('carta-volteada');
                }, 300);
            }, 300);
        }
    }

    // Funci√≥n para pedir carta a la mano activa
    async function pedirCarta() {
        if (!juegoActivo) return;

        const manoActiva = manosJugador[manoActivaIndex];
        const nuevaCarta = repartirCartaAleatoria();

        manoActiva.cartas.push(nuevaCarta);
        manoActiva.puntos = calcularPuntos(manoActiva.cartas);

        const manoElement = document.getElementById(`mano-element-${manoActivaIndex}`);
        await repartirCarta(manoElement, nuevaCarta, false, 0);

        actualizarUIManos();

        // Verificar si se pas√≥ de 21
        if (manoActiva.puntos > 21) {
            infoJuego.textContent = `¬°Mano ${manoActivaIndex + 1} se pas√≥ de 21!`;
            manoActiva.completada = true;
            siguienteMano();
        }
    }

    // Funci√≥n para pasar a la siguiente mano
    function siguienteMano() {
        // Buscar siguiente mano no completada
        const siguienteIndex = manosJugador.findIndex((mano, index) =>
            index > manoActivaIndex && !mano.completada
        );

        if (siguienteIndex !== -1) {
            manoActivaIndex = siguienteIndex;
            actualizarUIManos();
            infoJuego.textContent = `Turno de la Mano ${manoActivaIndex + 1}`;
        } else {
            // Todas las manos completadas, turno del crupier
            infoJuego.textContent = 'Todas las manos completadas. Turno del crupier...';
            turnoCrupier();
        }
    }

    // Funci√≥n para el turno del crupier (CORREGIDA: no pide si tiene 17-21)
    async function turnoCrupier() {
        juegoActivo = false;
        actualizarControles();

        infoJuego.textContent = 'Turno del crupier...';

        // Voltear carta oculta del crupier
        voltearCartaCrupier();

        // Calcular puntos del crupier
        const puntosCrupierCalculados = calcularPuntos(manoCrupierCartas);
        puntosCrupier.textContent = `Puntos: ${puntosCrupierCalculados}`;

        await new Promise(resolve => setTimeout(resolve, 1000));

        // CRUPIER SOLO PIDE SI TIENE MENOS DE 17 PUNTOS
        let puntosActuales = puntosCrupierCalculados;
        while (puntosActuales < 17) {
            infoJuego.textContent = 'Crupier pide carta...';
            await new Promise(resolve => setTimeout(resolve, 1000));

            const nuevaCarta = repartirCartaAleatoria();
            manoCrupierCartas.push(nuevaCarta);
            await repartirCarta(manoCrupier, nuevaCarta, false, 0);

            puntosActuales = calcularPuntos(manoCrupierCartas);
            puntosCrupier.textContent = `Puntos: ${puntosActuales}`;

            if (puntosActuales > 21) break;
        }

        await determinarResultado();
    }

    // Funci√≥n para determinar resultado de todas las manos
    async function determinarResultado() {
        await new Promise(resolve => setTimeout(resolve, 1000));

        const puntosCrupier = calcularPuntos(manoCrupierCartas);
        let gananciaTotal = 0;
        let resultados = [];

        // Evaluar cada mano del jugador
        manosJugador.forEach((mano, index) => {
            if (mano.puntos > 21) {
                resultados.push(`Mano ${index + 1}: Te pasaste - Pierdes $${mano.apuesta}`);
            } else if (puntosCrupier > 21) {
                resultados.push(`Mano ${index + 1}: Crupier se pas√≥ - Ganas $${mano.apuesta * 2}`);
                gananciaTotal += mano.apuesta * 2;
            } else if (mano.puntos > puntosCrupier) {
                resultados.push(`Mano ${index + 1}: Ganas - +$${mano.apuesta * 2}`);
                gananciaTotal += mano.apuesta * 2;
            } else if (mano.puntos === puntosCrupier) {
                resultados.push(`Mano ${index + 1}: Empate - Recuperas $${mano.apuesta}`);
                gananciaTotal += mano.apuesta;
            } else {
                resultados.push(`Mano ${index + 1}: Pierdes - -$${mano.apuesta}`);
            }
        });

        // Actualizar saldo
        saldoJugador += gananciaTotal;
        actualizarApuestaDisplay();

        infoJuego.textContent = resultados.join(' | ');
        finalizarRonda();
    }

    // Funci√≥n para implementar DOBLAR apuesta
    async function doblarApuesta() {
        if (!juegoActivo) return;

        const manoActiva = manosJugador[manoActivaIndex];
        const apuestaDoblada = manoActiva.apuesta * 2;

        if (apuestaDoblada <= saldoJugador + apuestaBase) {
            // Ajustar saldo y apuesta
            const diferencia = manoActiva.apuesta;
            saldoJugador -= diferencia;
            manoActiva.apuesta = apuestaDoblada;
            apuestaBase += diferencia;

            actualizarApuestaDisplay();
            infoJuego.textContent = `Apuesta doblada: $${manoActiva.apuesta}`;

            // Pedir una sola carta y completar autom√°ticamente esta mano
            await pedirCarta();

            if (manoActiva.puntos <= 21) {
                manoActiva.completada = true;
                siguienteMano();
            }
        } else {
            infoJuego.textContent = "No tienes suficiente saldo para doblar";
        }
    }

    // Funci√≥n para implementar DIVIDIR
    async function dividirMano() {
        if (!juegoActivo) return;

        const manoActual = manosJugador[manoActivaIndex];

        // Verificar que se puede dividir (2 cartas del mismo valor)
        if (manoActual.cartas.length !== 2) {
            infoJuego.textContent = "Solo puedes dividir con exactamente 2 cartas";
            return;
        }

        if (manoActual.cartas[0].valor !== manoActual.cartas[1].valor) {
            infoJuego.textContent = "Solo puedes dividir cartas del mismo valor";
            return;
        }

        if (manoActual.apuesta > saldoJugador + apuestaBase) {
            infoJuego.textContent = "No tienes suficiente saldo para dividir";
            return;
        }

        // Crear segunda mano con la misma apuesta
        const segundaCarta = manoActual.cartas.pop();
        manoActual.puntos = calcularPuntos(manoActual.cartas);

        const nuevaMano = {
            cartas: [segundaCarta],
            apuesta: manoActual.apuesta,
            puntos: calcularPuntos([segundaCarta]),
            completada: false
        };

        manosJugador.splice(manoActivaIndex + 1, 0, nuevaMano);

        // Descontar apuesta adicional del saldo
        saldoJugador -= manoActual.apuesta;
        apuestaBase += manoActual.apuesta;
        actualizarApuestaDisplay();

        enModoSplit = true;
        actualizarUIManos();

        infoJuego.textContent = "Mano dividida. Repartiendo cartas...";

        // Repartir carta a la primera mano dividida
        await new Promise(resolve => setTimeout(resolve, 500));
        await pedirCarta();
    }

    // Funci√≥n para seleccionar ficha
    function seleccionarFicha(valor) {
        if (juegoActivo) return;

        const nuevaApuesta = apuestaBase + parseInt(valor);

        if (nuevaApuesta <= saldoJugador) {
            apuestaBase = nuevaApuesta;
            actualizarApuestaDisplay();

            const ficha = document.querySelector(`.ficha[data-valor="${valor}"]`);
            ficha.classList.add('ficha-apostada');
            setTimeout(() => ficha.classList.remove('ficha-apostada'), 500);
        } else {
            infoJuego.textContent = "¬°No tienes suficiente saldo!";
        }
    }

    // Funci√≥n para actualizar display de apuesta
    function actualizarApuestaDisplay() {
        apuestaDisplay.textContent = apuestaBase;
        saldoDisplay.textContent = saldoJugador;
    }

    // Funci√≥n para iniciar nueva partida
    function nuevaPartida() {
        if (apuestaBase === 0) {
            infoJuego.textContent = "¬°Primero haz tu apuesta!";
            return;
        }

        // Reiniciar variables
        manoCrupierCartas = [];
        manosJugador = [];
        manoActivaIndex = 0;
        enModoSplit = false;
        crearMazo();

        // Limpiar interfaces
        manoCrupier.innerHTML = '';
        manosJugadorContainer.innerHTML = '';
        puntosCrupier.textContent = 'Puntos: ?';

        // Crear mano inicial del jugador
        manosJugador.push({
            cartas: [],
            apuesta: apuestaBase,
            puntos: 0,
            completada: false
        });

        // Descontar apuesta del saldo
        saldoJugador -= apuestaBase;
        actualizarApuestaDisplay();

        apuestaContainer.style.opacity = '0.5';
        juegoActivo = true;
        actualizarControles();

        infoJuego.textContent = `Apuesta: $${apuestaBase} - ¬°Buena suerte!`;
        repartirCartasIniciales();
    }

    // Funci√≥n para repartir cartas iniciales
    async function repartirCartasIniciales() {
        // Repartir 2 cartas al jugador (primera mano)
        for (let i = 0; i < 2; i++) {
            const carta = repartirCartaAleatoria();
            manosJugador[0].cartas.push(carta);

            const manoElement = document.getElementById('manosJugador');
            if (!manoElement.children[0]) {
                actualizarUIManos();
            }

            const manoActualElement = document.getElementById(`mano-element-0`);
            await repartirCarta(manoActualElement, carta, false, i * 300);
        }

        // Repartir 2 cartas al crupier (primera boca abajo)
        for (let i = 0; i < 2; i++) {
            const carta = repartirCartaAleatoria();
            manoCrupierCartas.push(carta);
            await repartirCarta(manoCrupier, carta, i === 0, 600 + i * 300);
        }

        // Actualizar puntos iniciales
        manosJugador[0].puntos = calcularPuntos(manosJugador[0].cartas);
        actualizarUIManos();

        // Verificar blackjack natural
        if (manosJugador[0].puntos === 21) {
            infoJuego.textContent = '¬°Blackjack Natural!';
            manosJugador[0].completada = true;
            setTimeout(() => turnoCrupier(), 1000);
        }

        // Actualizar estado de botones
        actualizarControles();
    }

    // Funci√≥n para actualizar controles
    function actualizarControles() {
        const manoActiva = manosJugador[manoActivaIndex];
        const puedeDividir = juegoActivo &&
            manoActiva &&
            manoActiva.cartas.length === 2 &&
            manoActiva.cartas[0].valor === manoActiva.cartas[1].valor &&
            saldoJugador + apuestaBase >= manoActiva.apuesta;

        const puedeDoblar = juegoActivo &&
            manoActiva &&
            manoActiva.cartas.length === 2 &&
            saldoJugador + apuestaBase >= manoActiva.apuesta;

        btnPedir.disabled = !juegoActivo;
        btnPlantarse.disabled = !juegoActivo;
        btnDoblar.disabled = !puedeDoblar;
        btnDividir.disabled = !puedeDividir;
    }

    // Funci√≥n para finalizar ronda
    function finalizarRonda() {
        juegoActivo = false;
        apuestaContainer.style.opacity = '1';
        apuestaBase = 0;
        actualizarApuestaDisplay();
        actualizarControles();
    }

    // Event Listeners
    fichas.forEach(ficha => {
        ficha.addEventListener('click', () => {
            seleccionarFicha(ficha.dataset.valor);
        });
    });

    btnNuevaPartida.addEventListener('click', nuevaPartida);
    btnPedir.addEventListener('click', pedirCarta);

    btnPlantarse.addEventListener('click', () => {
        if (!juegoActivo) return;

        manosJugador[manoActivaIndex].completada = true;
        siguienteMano();
    });

    btnDoblar.addEventListener('click', doblarApuesta);
    btnDividir.addEventListener('click', dividirMano);

    // Inicializar
    crearMazo();
    actualizarControles();
    actualizarApuestaDisplay();
</script>
</body>
</html>